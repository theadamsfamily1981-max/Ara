# OpenOCD Configuration for Intel Stratix 10 FPGAs
# Common in cryptocurrency mining hardware (Ethereum, etc.)
#
# Usage: openocd -f stratix10.cfg

# ============================================================================
# JTAG Adapter Configuration
# ============================================================================

# Common USB JTAG adapters for Stratix 10:
# - Intel USB-Blaster II
# - FT2232H-based adapters
# - Olimex ARM-USB-TINY-H (with modifications)

# Uncomment ONE of the following based on your adapter:

# Option 1: Intel USB-Blaster (most common for mining boards)
# adapter driver usb_blaster
# usb_blaster_vid_pid 0x09fb 0x6010 0x09fb 0x6810

# Option 2: FTDI FT2232H (generic JTAG cable)
adapter driver ftdi
ftdi_vid_pid 0x0403 0x6010
ftdi_layout_init 0x0008 0x000b
ftdi_layout_signal nTRST -data 0x0100 -oe 0x0100
ftdi_layout_signal nSRST -data 0x0200 -oe 0x0200

# Option 3: Olimex ARM-USB-TINY-H
# adapter driver ftdi
# ftdi_vid_pid 0x15ba 0x002a
# ftdi_layout_init 0x0808 0x0a1b
# ftdi_layout_signal nSRST -oe 0x0200

# JTAG speed (can be increased to 10MHz for stable connections)
adapter speed 5000

# ============================================================================
# Stratix 10 Target Configuration
# ============================================================================

# Stratix 10 JTAG IDCODE variants:
# - 10SX: 0x02D020DD (SX1100, SX2100)
# - 10GX: 0x02D120DD (GX1100, GX2100)
# - 10MX: 0x02D220DD (MX1100, MX2100)

# Set expected JTAG chain (single Stratix 10)
jtag newtap stratix10 tap -irlen 10 -expected-id 0x02D020DD -expected-id 0x02D120DD

# Create target
target create stratix10.arm cortex_a -chain-position stratix10.tap

# ============================================================================
# Flash Configuration (for bootloader bypass)
# ============================================================================

# Stratix 10 typically uses:
# - QSPI NOR Flash (Micron MT25QU512, Spansion S25FL512)
# - eMMC (for some mining boards)

# QSPI Flash configuration (128MB typical)
flash bank stratix10.qspi cfi 0x00000000 0x8000000 2 2 stratix10.arm

# ============================================================================
# Mining Board Specific Configurations
# ============================================================================

# Common mining board variants:
#
# 1. Squire Mining Bitfury Tardis (Stratix 10 SX 2800)
#    - 2x Stratix 10 SX 2800
#    - DDR4 HBM2 hybrid memory
#    - Custom PMIC (TI TPS53647)
#
# 2. Bitmain Antminer S19 FPGA Edition (Stratix 10 GX 2100)
#    - 4x Stratix 10 GX 2100
#    - 32GB DDR4 per FPGA
#    - Custom firmware on SPI flash
#
# 3. Generic development boards (Stratix 10 Dev Kit)
#    - Standard Intel reference design

# ============================================================================
# Useful Commands
# ============================================================================

# Scan JTAG chain: openocd -f stratix10.cfg -c "init; scan_chain; shutdown"
# Erase flash: openocd -f stratix10.cfg -c "init; flash erase_sector 0 0 last; shutdown"
# Program SOF: Use Quartus Programmer or Intel FPGA Tools
# Read memory: openocd -f stratix10.cfg -c "init; mdw 0x00000000 64; shutdown"
