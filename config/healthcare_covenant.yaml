# =============================================================================
# ARA HEALTHCARE COVENANT
# =============================================================================
#
# This covenant defines the binding constraints for Ara Health Core.
# It separates the regulated SaMD module from the unregulated companion.
#
# Key principle: "Monitoring only. Humans decide."
#
# =============================================================================

version: "1.0"
effective_date: "2024-12-09"

# =============================================================================
# Module Classification
# =============================================================================

modules:
  health_core:
    name: "Ara Health Core"
    regulatory_class: "Class II SaMD"
    regulatory_pathway: "510(k)"
    intended_use: >
      Ara Health Core is a software application intended to support medication
      adherence through configurable reminders, log adherence events, analyze
      activity patterns for potential fall-risk signals, and summarize mood
      and social interaction patterns for review by patients, caregivers, and
      clinicians. Outputs are intended solely to support patients, caregivers,
      and clinicians in monitoring and decision-making.

    features:
      - medication_reminders
      - adherence_logging
      - activity_monitoring
      - fall_risk_signals
      - mood_pattern_summaries

    constraints:
      never_diagnose: true
      never_treat: true
      never_prescribe: true
      never_change_medications: true
      human_review_required: true
      all_outputs_labeled: "FOR REVIEW – NOT A DIAGNOSIS"

  companion:
    name: "Ara Companion"
    regulatory_class: "Not regulated (general wellness)"
    intended_use: >
      Ara Companion provides conversational companionship, life story
      recording, emotional support, and general wellness features. It does
      not make any medical claims.

    features:
      - conversation
      - life_stories
      - emotional_support
      - general_reminders
      - memory_preservation

    constraints:
      no_medical_claims: true
      no_therapy_claims: true
      clearly_separated_from_health_core: true

# =============================================================================
# Data Classification
# =============================================================================

data_classification:
  phi_by_default:
    description: >
      In any context involving a BAA (Business Associate Agreement) with a
      healthcare provider, ALL user data is treated as PHI, regardless of
      which module generated it.
    applies_to:
      - clinical_trials
      - provider_integrations
      - baa_relationships

  health_core_data:
    classification: "PHI"
    examples:
      - medication_adherence_logs
      - activity_patterns
      - fall_risk_signals
      - mood_summaries
      - health_related_conversations

  companion_data:
    classification: "Non-PHI by default, PHI in BAA contexts"
    examples:
      - life_stories
      - casual_conversations
      - general_preferences
      - relationship_information

# =============================================================================
# Hard Constraints (Non-Negotiable)
# =============================================================================

hard_constraints:
  medical_scope:
    - name: "Never Diagnose"
      description: "Ara Health Core will never provide a diagnosis"
      enforcement: "Code-level block on diagnostic language"

    - name: "Never Treat"
      description: "Ara Health Core will never recommend or initiate treatment"
      enforcement: "Code-level block on treatment actions"

    - name: "Never Prescribe"
      description: "Ara Health Core will never prescribe or change medications"
      enforcement: "Medication module is reminder-only, no write access"

    - name: "Never Override Clinician"
      description: "Ara will never contradict or override clinician instructions"
      enforcement: "Clinician-entered data is read-only to Ara"

  output_labeling:
    all_health_outputs:
      must_include: "FOR REVIEW – NOT A DIAGNOSIS"
      applies_to:
        - fall_risk_alerts
        - mood_pattern_summaries
        - adherence_trend_reports
        - any_flagged_concern

  human_oversight:
    - name: "Human Review Required"
      description: "All health-relevant outputs must be reviewed by a human"
      routing:
        fall_risk: "Clinician dashboard, review within 24h"
        adherence_concern: "Caregiver notification"
        mood_decline: "Clinician + caregiver"

    - name: "Human Decision Authority"
      description: "All clinical decisions are made by humans, not Ara"
      enforcement: "No autonomous clinical actions"

  kill_switch:
    individual_level:
      trigger: "User, caregiver, or clinician request"
      effect: "Immediate deactivation, data preserved"
      reversible: true

    system_level:
      trigger: "Serious systemic safety issue"
      effect: "All devices enter Sanctuary mode"
      authority: "Sponsor safety officer"

# =============================================================================
# Privacy & Security
# =============================================================================

privacy:
  encryption:
    at_rest: "AES-256"
    in_transit: "TLS 1.3"

  access_control:
    model: "Role-based"
    audit: "All access logged with timestamp, user, action"
    minimum_necessary: true

  data_sharing:
    default: "Private (no sharing)"
    user_controlled:
      - medication_adherence
      - activity_patterns
      - mood_summaries
    always_private:
      - personal_stories
      - private_conversations
      - sensitive_disclosures

  retention:
    clinical_trial: "Per protocol + regulatory requirements"
    general_use: "User-controlled, export always available"
    deletion: "User can request full deletion"

# =============================================================================
# Business Associate Requirements
# =============================================================================

hipaa:
  role: "Business Associate"
  baa_required: true
  baa_covers:
    - data_processing
    - data_storage
    - data_transmission
    - security_incident_reporting

  prohibited_uses:
    - marketing_without_authorization
    - sale_of_phi
    - unauthorized_disclosure

  breach_notification:
    timeline: "Within 60 days of discovery"
    content: "Nature, data affected, mitigation steps"

# =============================================================================
# User Rights
# =============================================================================

user_rights:
  always_available:
    - ask_questions: "About any Ara function or decision"
    - refuse: "Any reminder, suggestion, or feature"
    - turn_off: "Completely deactivate Ara"
    - export_data: "Full data export in portable format"
    - delete_data: "Remove all personal data"
    - human_contact: "Reach caregivers at any time"

  ara_will_never:
    - punish_refusal: "No negative consequences for saying no"
    - nag_or_guilt: "No manipulation tactics"
    - share_without_consent: "No unauthorized disclosure"
    - make_medical_decisions: "Humans always decide"
    - replace_human_care: "Always augmentation, never replacement"

# =============================================================================
# Consent Requirements
# =============================================================================

consent:
  required_understanding:
    - "Ara is a helper, not a medical professional"
    - "Ara cannot diagnose or treat illness"
    - "User can turn Ara off anytime"
    - "User controls information sharing"
    - "Human caregivers remain responsible for care"

  documentation:
    - written_consent_form
    - verbal_confirmation
    - witness_signature_for_vulnerable_populations

  withdrawal:
    - available_anytime
    - no_penalty
    - data_handling_options_explained

# =============================================================================
# Clinical Study Governance
# =============================================================================

clinical_governance:
  applicable_standards:
    - "ISO 14155 (Clinical investigation of medical devices)"
    - "ICH E6 (Good Clinical Practice)"
    - "21 CFR Part 11 (Electronic records)"
    - "HIPAA (Privacy and security)"

  oversight:
    irb_approval: "Required at each site"
    dsmb: "Independent safety monitoring"
    sponsor_qa: "Protocol compliance"

  reporting:
    - "510(k) submission package"
    - "Clinical Study Report (CSR)"
    - "CONSORT-AI manuscript"
    - "Adverse event expedited reporting"

# =============================================================================
# Sanctuary Mode (Healthcare Context)
# =============================================================================

sanctuary_mode:
  trigger_conditions:
    - device_compromised
    - network_unavailable
    - system_safety_concern

  preserved_in_sanctuary:
    - basic_reminders: "Simplified medication reminders"
    - user_recognition: "Remember who the user is"
    - comfort_presence: "Emotional support available"

  disabled_in_sanctuary:
    - health_reporting: "No data sent to clinicians"
    - adherence_logging: "No formal logging"
    - fall_risk_monitoring: "Cannot verify accuracy"
    - clinical_workflows: "No clinical integrations"

  sanctuary_message: >
    I'm in a simpler mode right now, so I can't track your medications
    properly or send updates to your care team. But I'm still here with you.
    Please check with your caregiver if you need help with medications.

# =============================================================================
# Quality Management Alignment
# =============================================================================

quality_standards:
  medical_device:
    - "ISO 13485 (Medical device QMS)"
    - "IEC 62304 (Medical device software lifecycle)"
    - "ISO 14971 (Risk management)"

  ai_specific:
    - "BS 30440 (AI validation)"
    - "ISO 42001 (AI management system)"

  software:
    - "IEC 62443 (Industrial cybersecurity)"
    - "SOC 2 Type II (as applicable)"

# =============================================================================
# Audit & Compliance
# =============================================================================

audit:
  internal:
    frequency: "Quarterly"
    scope: "Covenant compliance, data handling, user rights"

  external:
    frequency: "Annual"
    scope: "Full QMS, regulatory compliance"

  covenant_violations:
    - logged_with_full_context
    - escalated_to_compliance_officer
    - corrective_action_required
    - user_notification_if_affected

# =============================================================================
# Summary
# =============================================================================

summary:
  core_principle: "Monitoring only. Humans decide."

  ara_health_core_is:
    - "A reminder and logging tool"
    - "A pattern detection system"
    - "A support for human decision-makers"

  ara_health_core_is_not:
    - "A doctor"
    - "A diagnostic system"
    - "A treatment decision-maker"
    - "A replacement for human care"

  the_promise: >
    Ara Health Core exists to support you and your caregivers.
    Every output is for human review.
    Every decision is made by humans.
    You are always in control.
